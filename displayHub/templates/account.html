{% extends "base.html" %}
{% block baseContents %}
{% load static %}

<style>
  /* Flexbox for sidebar layout */
  .row.flex-nowrap {
      display: flex;
      flex-wrap: nowrap;
  }

  /* Sidebar styling */
  .sidebar {
      width: 250px;
      background-color: #f8f9fa;
      min-height: 100vh;
      padding: 15px;
      border-right: 1px solid #dee2e6;
  }

  .sidebar-header {
      margin-bottom: 30px;
  }

  .nav-link {
      color: #333;
      padding: 10px 15px;
      border-radius: 5px;
      transition: all 0.3s;
      display: flex;
      align-items: center;
  }

  .nav-link:hover {
      background-color: #e9ecef;
  }

  .nav-link i {
      margin-right: 10px;
      color: #7C4DFF;
  }

  .nav-link.active {
      background-color: #7C4DFF;
      color: white;
  }

  .nav-link.active i {
      color: white;
  }

  .logout-btn {
      background-color: #7C4DFF;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      width: 100%;
      margin-top: 20px;
      transition: all 0.3s;
  }

  .logout-btn:hover {
      background-color: #6a3cdd;
  }

  /* For main content on the right */
  .content {
      padding-left: 20px;
      flex-grow: 1; /* Ensure the content takes up the remaining space */
  }
</style>

<div class="container-fluid">
  <div class="row flex-nowrap">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
          <h3>Menu</h3>
      </div>
      <ul class="nav flex-column">
          <li class="nav-item">
              <a href="{% url 'account' %}" class="nav-link {% if request.resolver_match.url_name == 'account' %}active{% endif %}">
                  <i class="bi bi-person"></i>
                  <span>Account</span>
              </a>
          </li>
          <li class="nav-item">
              <a href="{% url 'address' %}" class="nav-link {% if request.resolver_match.url_name == 'address' %}active{% endif %}">
                  <i class="bi bi-geo-alt"></i>
                  <span>Address</span>
              </a>
          </li>
          <li class="nav-item">
              <a href="{% url 'order' %}" class="nav-link {% if request.resolver_match.url_name == 'order' %}active{% endif %}">
                  <i class="bi bi-bag"></i>
                  <span>Order</span>
              </a>
          </li>
          <li class="nav-item">
              <a href="{% url 'coupon' %}" class="nav-link {% if request.resolver_match.url_name == 'coupon' %}active{% endif %}">
                  <i class="bi bi-ticket"></i>
                  <span>Coupon</span>
              </a>
          </li>
          <li class="nav-item">
              <a href="{% url 'wellat' %}" class="nav-link {% if request.resolver_match.url_name == 'wellat' %}active{% endif %}">
                  <i class="bi bi-wallet2"></i>
                  <span>Wallet</span>
              </a>
          </li>
      </ul>
      <a href="{% url 'logout' %}" class="btn logout-btn">
          <i class="bi bi-box-arrow-right"></i>
          Logout
      </a>
    </div>

    <!-- Main content -->
    <div class="content">
      {% block accountContent %}
      <div class="col py-3">
        <div class="container">
          <table class="table table-responsive">
            <tbody>
              <tr>
                <th scope="row">Name</th>
                <td>{{ user.first_name|upper }} {{ user.last_name|upper }}</td>
              </tr>
              <tr>
                <th scope="row">Username</th>
                <td>{{ user.username }}</td>
              </tr>
              <tr>
                <th scope="row">Email</th>
                <td colspan="2">{{ user.email }}</td>
              </tr>
            </tbody>
          </table>
          <div class="d-grid gap-2 d-sm-flex justify-content-sm-start">
              <button type="button" onclick="confirmPasswordChange('{% url 'changePassword' %}'); return false;" class="btn btn-outline-danger">Change Password</button>
              <button type="button" class="btn btn-outline-success mt-2 mt-sm-0 mx-md-3" onclick="confirmEditProfile('{% url 'editProfile' %}'); return false;">Edit Profile</button>
          </div>          
        </div>
      </div>
      {% endblock %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var rows = document.querySelectorAll('.clickable-row');

    rows.forEach(function(row) {
      row.addEventListener('click', function(event) {
        if (event.target.tagName.toLowerCase() === 'button' ||
            event.target.tagName.toLowerCase() === 'a') {
          return;
        }
        window.location.href = this.dataset.url;
      });
    });
  });

  function confirmPasswordChange(url) {
    Swal.fire({
      title: 'Are you sure?',
      text: "You are about to Change Password!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, change Password!'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = url;
      }
    });
  }

  function confirmEditProfile(url) {
    Swal.fire({
      title: 'Are you sure?',
      text: "You are about to Edit profile!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes, Edit Profile!'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = url;
      }
    });
  }
</script>
{% endblock %}